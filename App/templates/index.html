<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Report Form</title>
    <link rel="stylesheet" href="/App/static/index.css"> <!-- Link to form.css -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
   <div class="container">
    <div class="container-in">
        <nav>
            <h1>Activity Report Form | Student Activity Center</h1>
        </nav>
        <div class="main-section">
            <div class="main-section-one">
                <form id="activity-form" enctype="multipart/form-data">
                    <label for="club_name">Club Name:</label>
                    <input type="text" id="club_name" name="club_name" required ><br><br>
                    
                    <label for="event_name">Event Name:</label>
                    <input type="text" id="event_name" name="event_name" required ><br><br>
                    
                    <label for="event_description">Event Description:</label>
                    <input type="text" id="event_description" name="event_description" required ><br><br>

                    <label for="attendance">Total No of Attended:</label>
                    <input type="number" id="attendance" name="attendance" required ><br><br>
                    
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required ><br><br>

                    <label for="time">Time:</label>
                    <input type="time" id="time" name="time"required ><br><br>

                    <label for="venue">Venue:</label>
                    <input type="text" id="venue" name="venue" required ><br><br>
                    
                    <label for="image">Image:</label>
                    <input type="file" id="image" name="image" required ><br><br>
                    <a href="./next_page.html">
                        <input type="button" id="preview-btn" value="Preview">
                    </a>
                </form>    
            </div>
        </div>
    </div>
   </div>
   <script>
    $(document).ready(function() {
        // Function to handle click event of the preview button
        $('#preview-btn').click(function() {
            // Redirect to the next page for preview
            window.location.href = '/next_page.html';
        });

        $('#activity-form').submit(function(event) {
            event.preventDefault(); // Prevent default form submission

            // Serialize form data
            var formData = new FormData($(this)[0]);

            // Submit form data via AJAX
            $.ajax({
                type: 'POST',
                url: '/submit_form',
                data: formData,
                contentType: false,
                processData: false,
                success: function(response) {
                    // Display toast message
                    var toast = document.createElement('div');
                    toast.classList.add('toast');
                    toast.innerText = response.message;
                    document.body.appendChild(toast);

                    // Remove toast after 3 seconds
                    setTimeout(function() {
                        toast.style.opacity = '0';
                        setTimeout(function() {
                            document.body.removeChild(toast);
                        }, 1000);
                    }, 3000);

                    // Trigger download of the generated report
                    window.location.href = '/download_report';
                }
            });
        });
    });
</script>
</body>
</html>
